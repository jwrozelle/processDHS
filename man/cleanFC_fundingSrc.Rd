% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/cleanFC_fundingSrc.R
\name{cleanFC_fundingSrc}
\alias{cleanFC_fundingSrc}
\title{Harmonize SPA facility outside-funding sources to four non-exclusive buckets}
\usage{
cleanFC_fundingSrc(FCdata)
}
\arguments{
\item{FCdata}{A `data.frame`/`tibble` of SPA facility-level records that includes:
- a country/wave code in `v000` (e.g., `"MW6"`, `"AF7"`, `"BD7"`, `"ET8"`, `"HT7"`, `"NM09"`, `"NP8"`, `"TZ7"`),
- outside-funding items `v146a`, `v146b`, … (presence varies by country),
- and (where present) `v146y` (“None”), `v146z` (“Don’t know”).}
}
\value{
The input `FCdata` with additional columns:
- Country-specific flags (e.g., `funding_moh`, `funding_insurance`, …), as generated by the mapping;
- Harmonized buckets: `funding_h_public`, `funding_h_private`,
  `funding_h_nonstate`, `funding_h_other`;
- Optional convenience flags: `funding_h_none`, `funding_h_dk`, `funding_h_any`.
}
\description{
`cleanFC_fundingSrc()` reads country-specific SPA outside-funding items
(e.g., `v146a`, `v146b`, …), generates **country-level binary flags**
(e.g., `funding_moh`, `funding_insurance`, …), and then collapses them to
four **non-mutually-exclusive** harmonized indicators with the prefix
`funding_h_`:

- `funding_h_public`   (government sources: MoH/other ministries/local gov, social security, gov. subsidies to private)
- `funding_h_private`  (private insurance, employer reimbursement, user fees/internal revenue)
- `funding_h_nonstate` (donors/INGOs, faith-based, community, training colleges, bilateral & multilateral)
- `funding_h_other`    (catch-all “Other”)

It also adds convenience flags (when questionnaire variables exist):
`funding_h_none` (None), `funding_h_dk` (Don’t know), and `funding_h_any` (=1 if not None).
}
\details{
The function first maps each country’s `v146*` items to a small set of
**country-specific 0/1 flags** (e.g., `funding_moh`, `funding_insurance`,
`funding_userFees`, `funding_donorNGO`, `funding_bilateral`, etc.) using the
labels embedded in the code. It then aggregates those flags into the four
cross-country buckets listed above.

**Country nuances handled internally:**
- **NP8 (Nepal):** “Local level” (`v146d`) is treated as *public/local government*
  for harmonization (added as `funding_localGov` before collapsing).
- **HT7 (Haiti):** bilateral and multilateral cooperation are recognized and
  folded into `funding_h_nonstate`.
- **General:** If a referenced `v146*` item is absent in a country/wave, it is
  simply ignored in aggregation.

The harmonized buckets are **non-exclusive**: a facility may receive support
from multiple source types and thus have multiple `funding_h_* == 1`.
}
\section{Error handling}{

If `v000` is not one of the supported country/wave codes, the function raises
an error noting that the country has not yet been customized. Extend the
mapping blocks to add support for new waves.
}

\examples{
\dontrun{
# Minimal usage
out <- cleanFC_fundingSrc(FCdata)

# Tabulate harmonized coverage (non-exclusive)
cols <- c("funding_h_public","funding_h_private","funding_h_nonstate","funding_h_other")
sapply(cols, function(x) sum(out[[x]], na.rm = TRUE))

# Use in a model (e.g., include multiple funding types as covariates)
glm(y ~ funding_h_public + funding_h_private + funding_h_nonstate, data = out, family = binomial())
}

}
\seealso{
- SPA questionnaires/recodes for country-specific meanings of `v146*`.
- Your analysis code where these indicators are used as covariates.
}
